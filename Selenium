from selenium .webdriver.common.keys import Keys
import os
import random
from selenium import webdriver
import time
from tkinter import *

def sharePoint_popriri():

    nrRecords = int(input('Cate inregistrari cereri doriti sa inregistrati ? '))
    for i in range(nrRecords):
        title = {1: 'ceva', 2: 'altceva'}
        users = {1: 'ceva', 2: 'altceva', 3: 'ceva', 4: 'altceva'}
        random.choice(list(title.values()))
        # Drivere
        driver = webdriver.Chrome()
        driver.get('https://myssf.brd.ro/personal/alexandru_nicolae/Tactical_Squad/Lists/Pipeline%20Management/NewForm.aspx?Source=https%3A%2F%2Fmyssf%2Ebrd%2Ero%2Fpersonal%2Falexandru%5Fnicolae%2FTactical%5FSquad%2FLists%2FPipeline%2520Management%2FAllItems%2Easpx&RootFolder=')

        titleFiled = driver.find_element_by_id("Title_fa564e0f-0c70-4ab9-b863-0177e6ddd247_$TextField")
        titleFiled.send_keys(random.choice(list(title.values())))
        descField = driver.find_element_by_id("Test_8351a4c7-43d4-43fd-ae97-f69950c41fff_$TextField_inplacerte")
        descField.send_keys('Comentariu')

        logInButton = driver.find_element_by_xpath('//*[@id="Ribbon.ListForm.Edit.Commit.Publish-Large"]/span[1]')
        logInButton.click()
        time.sleep((2))
        driver.close()

def openBPM():

    # Drivere
    driver = webdriver.Chrome()
    driver.get('https://bpmtest.apps.brd.ro/ProcessPortal/')

    # Logare BPM
    userNameBpm = driver.find_element_by_id("username")
    userNameBpm.send_keys('adminRPA')
    passWord = driver.find_element_by_id("password")
    passWord.send_keys('adminRPA')
    logInButton = driver.find_element_by_xpath('//*[@id="signInForm"]/a/span')
    logInButton.click()

def openAllNetLg():

    # Drivere
    driver_1 = webdriver.Chrome()
    driver_1.get('https://h-login.safe.socgen/auth/?level=10&sourceURL=https%3A%2F%2Fhbtrf01f.safe.socgen%3A8004%2FebTrade%2Flogin')

    # Logare AllNet
    elm=driver_1.find_element_by_tag_name('html')
    elm.send_keys(Keys.END)
    time.sleep((5))
    driver_1.maximize_window()
    userName = driver_1.find_element_by_xpath("//input[@name='AUTHENTICATION.LOGIN']")
    userName.send_keys('AZ022153')
    passWord = driver_1.find_element_by_xpath("//input[@name='AUTHENTICATION.PASSWORD']")
    passWord.send_keys('Simplu19')
    loghinButton = driver_1.find_element_by_xpath('//*[@id="loginForm"]/button').click()
    time.sleep((5))
    userName = driver_1.find_element_by_xpath("/html/body/div[4]/div/div/div/div[2]/form/div[3]/input")
    userName.send_keys('MOB110')
    userPsw = driver_1.find_element_by_xpath("/html/body/div[4]/div/div/div/div[2]/form/div[4]/input")
    userPsw.send_keys('77')
    userPsw.send_keys(Keys.ENTER)


def openAllNetLc():

    # Drivere
    driver = webdriver.Chrome()
    driver.get('https://hbtrf01f.dns21.socgen:8004/ebTrade/login')

    time.sleep((5))
    userName = driver.find_element_by_xpath("/html/body/div[4]/div/div/div/div[2]/form/div[3]/input")
    userName.send_keys('MOB110')
    userPsw = driver.find_element_by_xpath("/html/body/div[4]/div/div/div/div[2]/form/div[4]/input")
    userPsw.send_keys('77')
    userPsw.send_keys(Keys.ENTER)



def deschidePddTrade():
    os.startfile("C:\\Users\\bogdan-laurentiu.bal\\Desktop\\Trade_Finance-Process_Design_Document.docx")

root = Tk()

menu = Menu(root)
root.config(menu=menu)
name = StringVar

toolbar = Frame(root, bg='red')

insertButt = Button(toolbar, text='Deschide BPM', command=openBPM)
insertButt.pack(side=LEFT, padx=2, pady=2)
toolbar.pack(side=TOP, fill=X)
insertButt = Button(toolbar, text='AllNet - LG', command=openAllNetLg)
insertButt.pack(side=LEFT, padx=2, pady=2)
insertButt = Button(toolbar, text='AllNet - LC', command=openAllNetLc)
insertButt.pack(side=LEFT, padx=2, pady=2)
toolbar.pack(side=TOP, fill=X)
insertButt = Button(toolbar, text='Deschide PDD', command=deschidePddTrade)
insertButt.pack(side=LEFT, padx=2, pady=2)
insertButt = Button(toolbar, text='Cereri Popriri', command=sharePoint_popriri)
insertButt.pack(side=LEFT, padx=2, pady=2)

entryName = Entry(root, textvariable = name, width=25, bg="lightgreen").place(x=280, y=200)
toolbar.pack(side = "bottom", fill = "both", expand = "yes")

root.mainloop()
